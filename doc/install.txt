Installation Instructions
=========================

OpenModes is written in the `Python <http://www.python.org/>`_ language, and
utilises the program gmsh to mesh the structure geometries.

Windows Quick Install
---------------------

The simplest way to get started is to download `Python(x,y) 
<https://code.google.com/p/pythonxy/>`_, which includes python and all the required python 
libraries. 

Then install `gmsh <http://geuz.org/gmsh/>`_, and make sure that the gmsh
executable is added to the windows PATH environment variable.

Download the `OpenModes <http://pypi.python.org/pypi/OpenModes>`_ executable package and
install it using the WinPython or Python(x,y) package manager.

Requirements
------------
The following software packages are the absolute minimum to run OpenModes:

- python 2.7 (3.x not currently supported)
- numpy (1.6.2 or later)
- scipy
- gmsh
- matplotlib (to plot the results)

Strongly recommended packages

- IPython (the notebook is used by many of the examples)
- pyvtk (to export 3D plots to vtk file format)
- ViSit or ParaView (3D plotting software to view vtk files)

Other packages which may be useful

- spyder (a GUI for editing python)
- mayavi (a python package for producing 3D plots)

OpenModes contains some core routines which are optimised using fortran.
Therefore, on platforms where a binary package of OpenModes is not provided,
a fortran compiler is required.


For windows users, there are several choices of scientific python distribution
which may also be suitable

- WinPython (known to work)
- Anaconda
- Enthought Python Distribution

Due to the lack of reliable free 64 bit fortran compilers for windows, you will
need to install a 32 bit version of any of these distributions

Ubuntu Linux
------------

For ubuntu users, the appropriate packages can be installed using the following
command

``sudo apt-get install python python-numpy python-matplotlib gmsh gfortran
ipython python-dev pyvtk python-pip``

OpenModes itself can then be installed using the command

``sudo pip install OpenModes``

Mac OSX
-------

This code has not been tested for Mac OSX, but there is no known reason why it should
not work. All required packages are available from the MacPorts project. 

Manual Install for Windows
--------------------------

Manual installation under windows is difficult, therefore it is recommended to use the
precomplied binaries. Compliation requires the use of 
mingw32 or mingw64 compilers, as these are the only free fortran compilers available for
windows. Unfortunately the default setting on most systems will not successfully
compile the required libraries.

As of version 4.8 and possibly earlier, Mingw32/64 have a bug which causes the
fortran extensions to randomly generate NaNs in the returned arrays if
optimisation levels -O2 or -O3 are specified, therefore the default optimisation
level has been set to -O1.

The 32 bit windows binaries were successfully built under the mingw-64 
x32-4.8.1-posix-dwarf-rev5 compiler. For 64 bit windows, binaries were successfully
build using the x64-4.8.1-posix-seh-rev5 compiler. Both were installed using the
`mingw-builds<http://sourceforge.net/projects/mingwbuilds/>`_ installer.

In order for setup.py to find these compilers, they must be in the path. To be safe,
ensure that no other C or fortran compilers are in the path. Python's distutils
must be instructed to use the mingw32 compiler (for both 32 or 64 bit), using the
--compiler flag, or by editing the file ``Lib/site-packages/distutils/distutils.cfg``
under your python installation.

In addition, for 64 bit versions, it is necessary to replace the line
``raise NotImplementedError("Only MS compiler supported with gfortran on win64")`` with 
``pass`` in the file ``Lib/site-packages/numpy/distutils/fcompiler/gnu.py``.

Downloading the Source
----------------------
The source is available on `GitHub <https://github.com/DavidPowell/OpenModes>`_

Building the Documentation
--------------------------

In order to build the documentation, the following packages are required

- numpydocs
- Sphinx

At a system command prompt, enter the ``doc`` directory and type ``make html``.
